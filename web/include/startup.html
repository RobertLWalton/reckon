<?php
// File:   startup.html
// Author: Robert L Walton <walton@acm.org>
// Date:   Wed Dec 27 03:10:01 EST 2023
// 
// The authors have placed RECKON (its files and the
// content of these files) in the public domain; they
// make no warranty and accept no liability for RECKON.

$time_format = "Y-m-d\Th:i:sT";

session_name ( $session_name );
session_start();
$_SESSION['IPADDR'] = $_SERVER['REMOTE_ADDR'];
$_SESSION['START_TIME'] =
    date ( $time_format, $_SERVER['REQUEST_TIME'] );
$_SESSION['HOST'] = $_SERVER['REMOTE_HOST'];
$browser = $_SERVER['HTTP_USER_AGENT'];
$browser = preg_replace
    ( '/\s*\([^\)]*\)\s*/', ' ', $browser );
$browser = preg_replace ( '/\s+/', ';', $browser );
$_SESSION['BROWSER'] = $browser;
 
?>
<html>
<head>
<script>
var oldwin = window.open ( 'index.php', 'reckon' );
oldwin.close();
const storage = window.localStorage;
var width = storage.getItem ( 'width' );
var height = storage.getItem ( 'height' );
var screenX = storage.getItem ( 'screenX' );
var screenY = storage.getItem ( 'screenY' );

if ( width === null )
    width = screen.availWidth / 3;
if ( height === null )
    height = screen.availHeight / 2;
if ( screenX === null )
    screenX = screen.availWidth - width;
if ( screenY === null )
    screenY = screen.availHeight / 4;

var ID = storage.getItem ( 'ID' );
if ( ID === null ) ID = '';

var win = window.open
    ( 'index.php?ID=' + ID, 'reckon',
      'height=' + height + 'px,' +
      'width=' + width + 'px,' +
      'screenX=' + screenX + 'px,' +
      'screenY=' + screenY + 'px' );
win.focus(); // Needed for Firefox but not Chrome.

</script>
</head>
<body>
    <h1> <span onclick="CLEAR_LOCAL_STORAGE()">
         &nbsp;&nbsp;&nbsp;&nbsp;</span>
         You can close this tab.</h1>

<script>
function CLEAR_LOCAL_STORAGE()
{
    window.localStorage.clear();
    console.log ( 'Local storage has been cleared.' );
}
</script>
</body>
</html>
